if test -z "${BOOT_SLOT}"; then
    echo "BOOT_SLOT not set, defaulting to slot_a"
    setenv BOOT_SLOT slot_a
fi

echo "Booting RAUC slot: ${BOOT_SLOT}"

if test "${BOOT_SLOT}" = "slot_b"; then
    setenv rootpart 3
else
    setenv rootpart 2
fi

load mmc 0:1 ${kernel_addr_r} Image
load mmc 0:1 ${fdt_addr_r} bcm2712-rpi-5-b.dtb

setenv bootargs "root=/dev/mmcblk0p${rootpart} rootfstype=ext4 rootwait console=tty1"
booti ${kernel_addr_r} - ${fdt_addr_r}
